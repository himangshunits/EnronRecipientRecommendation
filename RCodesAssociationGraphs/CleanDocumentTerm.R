# This fucntion reduces the size of the table document term from the org
# Takes the top 3000 words with higest frequency and deletes the other rows.

drv = dbDriver("MySQL")
con = dbConnect(drv, user="root", dbname="enron_document_term", password="test@123")

top500terms = dbGetQuery(con,"select term from document_term group by term order by count(*) desc limit 500;")
top500terms = as.character(top500terms[, 1])

#DELETE FROM document_term where term NOT IN('subject','enron','cc','pm','please','2001','forward','thanks','ect','know','com','hou','get','would','sent','2000','10','message','need','time','call','11','let','jeff','corp','attach','re','original','mark','12','make','may','work','1','also','go','date','one','like','question','see','sara','fax','send','713','want','new','regard','best','think','agreement','0','week','follow','receive','could','30','5','use','9','shackleton','houston','4','mail','3','change','issue','copy','take','information','2','853','group','give','jones','day','look','well','credit','power','meeting','list','legal','review','8','contact','na','dasovich','john','provide','include','back','office','energy','today','taylor','last','david','phone','tana','note','company','service','monday','6','email','friday','america','susan','thank','number','contract','request','say','im','7','help','next','dont','detail','team','ask','business','646','two','north','comment','trade','trading','smith','schedule','good','thursday','plan','name','15','first','market','20','gas','file','year','come','deal','find','try','wednesday','still','tuesday','price','street','financial','meet','state','talk','place','california','much','scott','since','people','late','bill','report','sure','document','draft','paul','master','set','counterparty','transaction','ill','way','14','end','16','form','13','october','add','customer','order','system','address','25','22','calendar','term','17','21','tomorrow','require','3490','louise','18','process','net','hope','thing','point','steve','right','per','leave','conference','1400','possible','karen','mike','sign','inc','isda','put','richard','start','soon','texas','77002','standard','19','many','23','tom','available','26','fyi','27','party','24','doc','month','however','product','approval','long','execute','mary','and','keep','update','discus','31','robert','28','access','description','stephanie','morning','support','29','global','offer','already','michael','might','move','current','high','cost','problem','agree','ena','able','tell','additional','anything','kitchen','return','continue','discuss','resource','interest','utility','complete','5620','confirm','response','letter','central','base','rate','open','mailto','whether','great','lon','eb','or','hold','direct','entry','bob','outlook','davis','another','migration','jam','etc','november','propose','check','free','believe','future','sally','frank','case','must','dave','fw','january','entity','buy','part','either','reference','prepare','pay','joe','feel','create','wholesale','around','line','together','respond','mara','yet','concern','50','http','approve','appointment','distribution','intend','greg','william','2002','even','id','eol','person','risk','due','early','anyone','position','something','beck','jim','revise','law','chairperson','final','run','lisa','management','general','show','hear','steffes','99','account','commission','alan','september','ive','really','communication','rick','several','limit','purchase','currently','version','others','ca','swap','basis','december','enronxgate','everyone','hour','ee','allow','understand','short','expect','result','public','confidential','contain','done','within','attend','london','suggest','effort','cover','without','close','yesterday','online','discussion','view','www','type','confirmation','room','prior','advise','guy','tim','addition','3801a','bradford','march','language','member','in','book','share','project','probably','hi','data','staff','steven','sell','chris','mean','notice','shapiro','else','amount','increase','appreciate','idea','sue','president','sale','45','enter','williams','opportunity','kevin','capital','three','the','seem','department','write','home','someone','electricity','cant','specific','clear','option','decision','event','brent','immediately','via','action','exchange','appear','40','remain','little','afternoon','begin','operation','read','relate','error','large','carol','enron_development','necessary','assume','ok','employee','non','sorry','otherwise','bring','co','distribute','february','consider','appropriate','didnt','firm','delete','big','leslie','lot','matter','individual','san','info','full','regulatory','area','purpose','june','april','past','side','speak','likely','policy','night','thomas','folk','effective','reason','proposal','counsel','electric','enrononline','ken','ees','july','lawyer','lead','answer','yes','ferc','associate','thought','senior','trader','focus','respect','structure','mention','moran','exist','program','attachment','jan','kean','page','release','far','commercial','though','upon','dan','supply','happy','level','0','heard','second','lavorato','physical','ensure','determine','although','certain','important','least','along','youre','control','counterparties','boyd','head','york','hard','harry','kaufman','million','marketing','kelly','tanya','thats','director','44','floor','cannot','35','chance','linda','location','notify','payment','couple','41','turn','hunter','reply','edison','36','enrons','application','involve','indicate','press','charge','word','key','weekend','center','click','therefore','minute','site','53','tx','up','43','52','join','wait','debbie','different','europe','fact','46','reach','news','eric','committee','commodity','cash','post','32','58','conversation','development','pg','old','47','manager','decide','panus','rule','st','total','gov','status','bank','accept','record','ph','governor','33','august','desk','develop','every','samuel','39','55','facility','directly','rather','assistant','brown','42','lambert','never','solution','value','recent','forster','low','government','actually','activity','unless','sound','corporation','brackett','behalf','hall','54','outside','period','provision','negotiate','material','51','course','canada','present','puc','recipient','brian','100','37','48','345','38','here','international','joseph','59','natural','jeffrey','49','user','manage','correct','brant','act','hearing','requirement','board','unit','fine','section','security','francisco','amendment','submit','happen','attorney','become','do','clark','small','ago','demand','pass','havent','always','presentation','potential','rohauer','jennifer','doesnt','56','job','peter','34','57','summary','less','link','memo','visit','top','participate','recently','white','item','miss','enough','aol','tax','various','ed','real','dynegy','summer','capacity','industry','kind','step','prohibit','ready','comnes','handle','settlement','track','jason','executive','approach','responsible','spoke','affiliate','administration','money','internal','experience','house','paper','belden','relevant','sender','web','deliver','nothing','reserve','disclosure','george','schott','rob','website','maybe','org','affair','plant','lynn','role','transmission','significant','tel','james','benefit','campbell','weather','operate','seller','generation','delivery','officer','serve','russell','internet','sever','bailey','lunch','mind','coordinate','crisis','west','suggestion','generator','gray','harris','vice','database','network','proceed','participant','initial','similar','wed','corporate','consumer','federal','gary','reduce','chief','nelson','stay','vacation','pretty','resolve','elizabeth','jdasovic','attempt','billion','cap','marie','mid','statement','to','voice','example','identify','apply','cynthia','dear','session','sheila','there','delay','douglas','cell','dwr','denne','reflect','establish','lose','finance','sacramento','away','derivative','hand','cal','clair','perhaps','special','condition','daily','documentation','duke','ever','pdx','andy','fund','authority','wont','raise','transfer','llc','415','wish','select','accord','pas','cpuc','investment','hansen','larry','asset','attention','ted','independent','aware','christopher','love','print','pick','announce','cook','obtain','kingerski','bit','situation','finalize','daniel','diamond','amend','saturday','guaranty','analyst','fill','kim','sit','evidence','for','format','reves','filing','allen','analysis','calpine','electronic','quick','telephone','four','hendry','molly','negotiation','asap','world','ginger','spot','advance','dinner','stephen','responsibility','drop','instead','rest','personnel','suite','five','et','remove','800','cheryl','light','password','shall','drive','particular','vote','which','fix','southern','lee','push','sandra','sense','importance','interested','lesli','fall','water','watch','calger','brief','effect','stock','bad','build','guarantee','quote','bruce','understanding','finally','1999','bond','strictly','tracy','technology','assign','carolyn','weve','everything','212','pipeline','previously','bankruptcy','lay','assistance','budget','separate','curry','evening','except','agency','ahead','computer','on','play','occur','among','ann','client','quickly','sarah','locate','force','content','dernehl','dollar','figure','veronica','haedicke','hardy','assignment','shelley','source','confidentiality','roger','ability','pacific','nancy','major','mccubbin','edu','execution','property','sunday','termination','incorporate','remember','rodriguez','cross','launch','earlier','estimate','resolution','goal','black','clean','out','previous','direction','fee','difference','average','claim','supplier','critical','face','palmer','represent','agenda','hey','ii','opinion','maureen','code','based','revenue','hesitate','strategy','simply','impact','retail','assist','building','care','legislative','official','organization','research','inform','johnson','us','seek','stop','legislature','near','explain','doug','longer','michelle','hopefully','sheri','travel','interview','iso','donna','oxley','main','blue','rely','stacey','trip','cp','eb3801a','senate','south','avoid','chairman','whalley','wood','sheet','unable','authorize','samantha','laura','local','difficult','generate','jay','pull','sort','test','dial','kimberly','article','function','justin','prefer','recommend','privilege','nice','x3','weekly','cut','fail','shortly','ubs','holiday','hr','class','american','andrea','edward','leader','fun','500','across','country','design','private','procedure','refer','implement','mr','live','earthlink','volume','jean','personal','progress','plus','andrew','bernice','bid','bradley','break','fully','third','miller','ny','city','portland','priority','produce','flow','express','outstanding','verify','welcome','wilson','gmssr','invite','murphy','corman','beth','uk','obviously','oil','pricing','roll','arrange','debt','load','guess','helpful','jack','alternative','arrangement','pending','sempra','anne','broker','916','whats','smara','national','game','investor','quite','easy','equity','de','obligation','whole','alamo','arrive','beginning','table','tony','conflict','espinoza','paragraph','reminder','representative','protect','specifically','western','le','barbara','kay','fred','pat','mtg','isnt','strong','court','annex','measure','save','stand','touch','canadian','as','charles','claudia','signature','hop','martin','sce','spend','suppose','administrative','input','ray','relationship','permit','learn','encourage','enjoy','parquet','rod','thus','town','he','affect','randy','replace','announcement','willing','cst','if','janet','story','tonight','transact','attached','greeting','hedge','listing','noon','core','el','extend','conduct','connection','pge','profile','republican','life','la','morgan','anyway','approximately','barry','grant','craig','assembly','overall','picture','index','sf','target','choice','collins','entire','feedback','liz','maintain','outline','washington','da','deadline','friend','bind','bowen','diego','finish','improve','hit','certainly','performance','agent','lees','buyer','regulation','pre','choose','acceptance','jonathan','legislation','sole','wonder','half','bryan','chair','reasonable','ross','sullivan','tammie','dow','of','jr','7751','division','particularly','hodge','cancel','wrong','bear','berkeley','lynch','east','90','this','unite','secure','privileged','782','unfortunately','host','generally','spreadsheet','whatever','lotus','met','moore','ball','gosnell','iii','insure','parent','own','patel','paula','balance','challenge','school','teresa','useful','mday','monitor','production','amy','front','highlight','family','shari','immediate','keith','glad','oct','single','young','phil','robertson','space','kent','baker','aronowitz','wireless','marty','applicable','better','box','brenda','delainey','peak','peggy','provider','stack','thompson','govenar','partner','piece','describe','apparently','los','medium','portion','angeles','by','commissioner','stanley','card','patti','prevent','govadv','it','iepa','speed','subsidiary','60','worry','schoppe','seems','sfo','association','default','actual','only','loss','melissa','model','nov','clearly','julie','topic','janel','ltd','authorized','oppose','perspective','political','possibility','draw','extremely','definition','factor','smutny','ticket','recall','reliantenergy','bottom','handling','hartsoe','affiliates','apology','feb','guerrero','hello','hotel','instruction','practice','promise','operator','retain','blackberry','cindy','commitment','novosel','nymex','shults','six','sgovenar','sharp','success','theyre','producer','acceptable','nature','favor','deregulation','emergency','especially','patrick','regulator','worth','glover','terminate','transportation','lindsay','megawatt','gtbl','haas','contribute','currency','definitely','phillip','package','presto','revision','expense','almost','foster','worksheet','wouldnt','lombardi','maria','off','external','including','specialist','stuff','study','anderson','completely','primary','profit','publish','recommendation','rise','youll','flynn','govern','cooper','dale','exposure','copyright','curtis','define','double','enforceable','pdf','quality','prompt','px','quarter','expand','technical','trust','combine','hereto','wall','advice','200','usual','percent','pr','richardson','margin','matt','mona','dec','eliminate','eta','collateral','gen','handheld','introduce','gain','participation','realize','region','air','border','busy','conclude','danny','coordinator','feature','gtc','leadership','monthly','oday','anticipate','commerce','owe','sager','perfect','resume','hedy','judge','communicate','wasnt','wes','msn','throughout','consistent','couldnt','dean','vicki','youve','gtcs','hotmail','grow','hare','jurisdiction','ron','1st','modify','no','x5','youd','dennis','environment','ext','availability','cause','ceo','competitive','greenberg','hain','jackp','successful','text','petrochko','disclose','mcvicker','screen','speaker','adam','6002','TRUE','tw','normal','annual','common','happens','red','x6','pelote','jana','button','carter','tariff','rebecca','reject','pursuant','road','angela','australia','behind','brokerage','gcp','juana','meredith','mobile','exception','extent','fayett','economic','estoppel','flight','fx','pigott','prc','pursue','chart','commit','merger','nda','kathy','blackout','campos','cdt','simple','vp','lawner','metal','888','secretary','sometime','trang','forget','fpl','history','kate','community','catch','failure','operating','register','restrict','jordan','75','split','diebner','eei','morse','anthony','block','regular','respective','investigation','grid','stacy','tie','platform','bev','burton','arise','christi','compliance','industrial','nguyen','offering','engage','recognize','task','template','title','season','sharon','spread','taffy','maley','apologize','ronan','ab','despite','darren','diane','edmund','ngo','sept','smtp','gordon','infrastructure','journal','compare','refund','pressure','rating','who','municipal','arnold','background','candidate','janette','implementation','voicemail','settle','consideration','auction','circulate','advantage','left','lednicky','milnthorp','size','stage','tycholiz','hill','hire','katie','piper','preliminary','rep','decline','enable','european','cent','comprehensive','all','calculate','hoffman','xl','yahoo','skean','spent','sufficient','trouble','curt','exceed','organize','positive','receipt','regulate','related','relation','saw','owner','paralegal','wanda','component','neal','negative','hgovenar','fwd','got','marketer','reliant','collect','colwell','davies','designate','1998','adams','origination','pa','fuel','iep','we','king','legally','none','confirms','curtis_l_kebler','dorothy','elbertson','field','al','allocate','calgary','causey','seiworldwide','significantly','transition','senator','usually','walter','win','operational','prentice','restriction','robinson','hertzberg','joer','appears','calculation','kristin','economy','enclose','eslawfirm','estate','count','excite','possibly','round','webb','with','knowledge','ogden','fit','kaplan','brad','carry','clarify','park','ponder','radous','reduction','ref','union','university','jenny','kebler','liability','nearly','recover','beyond','calif','cameron','achieve','fernley','gm','spokesman','tm','todd','treat','serious','surprise','toward','abb','originally','range','nicolay','buying','comfortable','gone','janine','huge','loretta','not','shop','specify','portfolio','professional','ratepayer','ryan','foreign','kaye','7th','lack','log','moment','netco','assumption','audit','cabaker','exactly','richter','seat','sen','software','stout','ten','tribolet','upcoming','arm','oh','koch','license','marcus','mistake','consultant','150','basic','carlson','warburg','wendi','you','extension','keohane','method','rogers','argument','boston','brazil','car','clarke','laurel','lebrocq','manner','matthew','merchant','debra','efficient','evaluate','freeze','invitation','reservation','5th','convenience','dissemination','nam','often','registration','rllamkin','greatly','growth','howard','integrate','suspend','urge','at','broad','certificate','whitehead','worldwide','wright','250','forth','gather','gngr','hatton','integration','paso','pool','perform','working','solve','store','training','travis','dhunter','argue','bridge','former','hereby','microsoft','neuner','400','accurate','adopt','4th','adnan','depend','desire','escalante','fair','okay','reform','shift','stewart','lewis','minimum','mw','imceanotes','impose','gillette','intent','panel','phase','pls','300','consent','derek','man','mcfadden','milligan','newell','lale','leite','mirant','mon','fri','hughes','jeremy','pinto','sam','sample','alex','automatically','christian','colleague','slide','so','steve_ponder','sun','van','food','green','lloyd','luce','neil','notification','damage','download','principal','powersrc','preparation','pulp','float','jane','above','accordingly','walker','shively','shown','slightly','soos','sr','strike','timely','connie','dallas','easily','ec','facilitate','await','commence','loan','meantime','neither','koehler','maintenance','whose','gough','guidroz','hap','inquiry','jmball','kassandra','blame','congratulation','crude','discount','edit','essentially','expedite','zipper','landwehr','luck','majority','objective','refuse','3399','650','70','survey','formal','frazier','hot','jackson','japan','john_h_stout','hyde','investigate','julee','exercise','expensive','explorer','mellencamp','mexico','somewhat','spring','theriot','utilize','belief','concept','80','environmental','palmerton','walk','broadband','kenneth','kgough','series','shut','suzanne','sweet','switch','rhonda','confusion','duane','excess','fast','40enron','95','human','legislator','multiple','newly','absence','active','recovery','rich','sa','sonya','conservation','dietrich','district','donald','arent','attendee','becky','below','allocation','bp','but','chuck','strategic','stuart','lhom','primarily','curve','dept','ellis','fercs','fulton','income','hasnt','julia','merrill','argentina','bhansen','carrie','2ecom','2nd','7822','search','suit','tool','ultimately','venture','effectively','election','explanation','extra','window','onto','path','proceeding','rwhyde','port','recruit','281','61','ag','malinowski','garcia','amber','burn','castillo','chase','christine','wide','sylvia','url','deem','dickson','diligence','egm','equal','doubt','8160','login','migrate','valuable','californian','vickers','owned','quantity','confuse','democrat','enas','clause','coal','mcdonald','shankman','storage','sub','shortage','spending','strongly','terry','tight','tomeo','ongoing','rescalante','riobravo','rsvp','acquire','adjustment','advocate','weisgall','woman','lamkin','construction','contractual','denton','alvarez','assessment','capture','coleman','apollo','capability','chapman','clint','3393','sutton','threshold','freeman','incentive','davy','faith','finding','volatility','lagrasta','louis','match','mcconnell','leff','mandola','mechanism','steel','thermoecotek','thu','7095','austin','bush','circumstance','sayre','video','initially','difficulty','dispute','door','embedded','exact','fairly','clickpaper','competition','kerner','kid','mwh','noncore','1996','3rd','guest','interim','jweisgall','kathleen','pager','potentially','repay','warn','warner','litigation','lobby','mrwassoc','dwrs','ene','erms','spike','treasury','twetzel','author','bar','carl','pro','protection','rbw','rush','goldman','import','instrument','greco','intends','socalgas','urgent','lance','wetzel','down','patricia','pc','preference','reliability','bet','body','chat','closing','column','self','separately','server','shes','sincerely','thome','timeline','hell','pacbell','paula_soos','personally','3488','dana','debate','duran','sector','sponsor','that','transwestern','alone','ap','assure','att','bcc','ben','campaign','yoder','lafuze','logistics','2308','98','redmond','rjhickok','safe','procurement','promotion','sablaw','satisfy','shareholder','shouldnt','simon','tab','uaecorp','eisenman','15th','agreed','hickok','joint','max','mcnallytemple','mine','minns','kmccrea','kyle','limitation','munoz','sdg','uncertainty','sb','billw','coalition','completion','fly','htm','ious','connect','county','earnings','eligible','esp','11th','206','acquisition','adequate','advisor','reporter','rub','loop','mccullough','mix','noske','wear','went','wfhall2','solicitation','terri','thanksgiving','threaten','underlie','consulting','dc','dedicate','dick','ebow','browser','complex','ford','gilbert','ground','ignore','initiative','insert','folder','going','jose','outcome','overview','promote','qualify','reliable','robertmondavi','503','larrea','lawsuit','suspension','tech','treasurer','truly','twice','deny','eileen','ellery','emission','conf','eastern','emerge','addressee','forum','heffernan','initiate','wayne','werent','percentage','retention','rita','sanders','sherriff','signal','suspect','suttle','testing','upgrade','anna','basically','cathy','complaint','mou','marty_mcfadden','mass','mpalmer','nord','ward','willey','winter','3831','derosa','dkk','eb4102','english','eye','fear','gate','highly','introduction','isenberg','jmunoz','jump','americas','benevides','californias','cite','ought','oversight','pete','sander','stick','ss','coordination','dnelsen','equipment','liquid','listen','mailbox','palo','partnership','player','rank','reaction','scale','fitzgerald','follows','grigsby','held','insurance','isdas','aim','award','cheap','closely','attack','avenue','beach','bonus','caithnessenergy','consolidate','democratic','elliott','entitle','everyones','scenario','singapore','tue','undercollection','valley','vanek','wind','writer','65','aa','from','health','html','incur','inside','khoffman','middle','murray','oconnell','perez','reeves','sat','regional','sacks','correction','counter','elect','felt','bilateral','caiso','chicago','christina','cmta','sec','skilling','student','substantial','told','kill','lawmaker','margaret','normally','2003','20th','acknowledge','additionally','gosselin','hmot','implication','instance','passcode','ring','sandi','walton','worldnet','deborah','device','elliottsa','exempt','schultz','sentence','strand','sum','unclear','usgen','laurie','linnell','maker','melba','merge','minor','lara','maximum','meanwhile','mm','necessarily','yoho','fundamental','hickerson','hillis','holding','improvement','kathryn','appeal','australian','billy','coast','redline','subsequent','throw','confident','creditor','destroy','drink','element','expectation','convert','decrease','ectric','enw','aside','booth','cob','land','lozano','functionality','image','interstate','invoice','shipper','socal','spi','theresa','thru','500','12th','253','opposition','relief','pst','rto','kerry','kick','lift','livelink','constitute','contribution','desktop','determination','divide','fielder','violate','approx','child','6th','fire','frequently','frevert','ind','intention','interesting','sometimes','scope','spell','timothy','trigger','usa','velaw','mill','mother','nation','newswires','philippe','prove','psellers','relative','conclusion','earn','epenergy','expert','familiar','heat','holly','appoint','birthday','briefly','christmas','cole','compete','8th','admin','464','707','absolutely','over','raymond','sensitive','ubsw','laughlin','mcmahon','mile','mom','alert','authorization','baughman','category','dunn','eat','exemption','fawcett','gossett','guideline','hedstrom','iliff','inactivate','iris','janice','framework','gerald','girl','imagine','institute','invest','kelley','sean','slow','solely','sooner','variety','13th','208','accounting','wine','wonderful','palm','poor','publication','reef','reschedule','restore','coral','council','csfb','dean_gosselin','del','delaney','feed','mba','mcnally','aint','airport','bellery','blachman','club','comply','aparna','aspect','blackline','blumenthal','brbarkovich','cody','wastemanagement','william_carlson','wire','selection','ship','temporary','tough','gonzalez','hang','hawkins','jefferson','joan','kelli','10am','600','acomnes','lindberg','marilyn','nelsen','object','objection','patience','principle','qf','regardless','restructuring','river','sachs','contains','degree','dr','earliest','demonstrate','detailed','dj','dowjones','eileenk','exhibit','fight','glen','ie','individually','internally','weisenmiller','zufferli','briggs','buchanan','carefully','shot','streamline','tammy','usd','olson','originator','penalty','perlman','perrino','portz','2600','30th','7906','accomplish','martha','modification','nick','migden','norton','alto','bell','bunch','compile','forecast','gap','correctly','criterion','domestic','dominic','employment','excellent','exit','expansion','zero','00pm','9th','shona','treatment','tweed','quarterly','remind','sap','overlay','ownership','representation','scan','continental','denis','deutsche','duty','efficiency','ex','badeer','compromise','mann','md','mess','northern','gross','jon','justify','slip','supervisor','viverito','whenever','will','750','202','3923','3e','lawrence','mar','offline','cool','coverage','crazy','cromwell','drothrock','eight','premium','prime','residential','rmt','attendance','benson','buckley','cftc','henry','herndon','hole','jeffery','siliff','soar','suffer','testimony','timing','totally','tues','typically','unlikely','southard','theyll','thurs','pdt','rgds','robin','ruling','length','montovano','1997','877','consult','epsa','exclude','fell','finger','gerard','golf','hydro','versus','allison','aucoin','baby','blank','brother','chamber','colleen','antonio','beverly','caroline','900','9897','accommodate','orientation','pleasure','rahil','rajaram','reality','saving','spoken','style','theyve','towards','transport','valid','llgm','machine')